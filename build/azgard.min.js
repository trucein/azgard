/**
 * Azgard 0.0.6
 * (c) 2016 
 * License: MIT
 */
!function(t,e){t.Version="0.0.1",t.PartialsPath="./partials",t.Service={},t.Modules={},t.Configs={},t.Filters={},t.Controllers={},t.Directives={},t.Constants={}}(window.AZGARD=window.AZGARD||{}),function(t,e){"use strict";t.AZGARD=angular.module("azgard",[])}(AZGARD.Modules=AZGARD.Modules||{}),function(t,e){AZGARD.Modules.AZGARD.config(["$httpProvider",function(t){t.interceptors.push("AzgardInterceptor")}])}(AZGARD.Configs=AZGARD.Configs||{}),function(t,e){t.Modules.AZGARD.factory("AzgardAction",["$http","AzgardShared","AzgardConfig",function(t,e,r){function n(n,o){return o=o||{},o.url=o.url?otps.url:r.baseUrl+r.loginSMSUrl,o.data=n||o.data,o.method=o.method||"POST",t(o).then(function(t){return e.setToken(t),t})}function o(){return e.removeToken(),opts={},opts.url=opts.url?otps.url:r.baseUrl+r.logoutUrl,opts.method=opts.method||"GET",t(opts).then(function(t){return t})}function i(e,n){return n=n||{},n.url=n.url?otps.url:r.baseUrl+r.registerUrl,n.data=e||n.data,n.method=n.method||"POST",t(n)}function u(e,n){return n=n||{},n.url=n.url?otps.url:r.baseUrl+r.otpUrl,n.data=e||n.data,n.method=n.method||"POST",t(n)}function a(e){return e=e||{},e.url=e.url?otps.url:r.baseUrl+r.profileUrl,e.method=e.method||"GET",t(e)}var l={};return l.loginOTP=n,l.logout=o,l.register=i,l.getOTP=u,l.getProfile=a,l}])}(window.AZGARD=window.AZGARD||{}),function(t,e){t.Modules.AZGARD.constant("AzgardConfig",{httpInterceptor:function(){return!0},baseUrl:"/",loginUrl:"/auth/login/",loginSMSUrl:"/auth/login_with_sms",profileUrl:"/user/profile",registerUrl:"/auth/register",registerAdminUrl:"/auth/admin/register",logoutUrl:"/auth/logout",otpUrl:"/auth/get/otp",authHeader:"X-Auth-Token",authToken:"",storageType:"localStorage",tokenName:"token",tokenPrefix:"azgard",loginPage:"#/login"})}(window.AZGARD=window.AZGARD||{}),function(t,e){t.Modules.AZGARD.factory("AzgardInterceptor",["$q","AzgardShared","AzgardConfig","AzgardStorage",function(t,e,r,n){return{request:function(t){if(t.skipAuthorization)return t;if(e.isAuthenticated()){var o=r.tokenPrefix?r.tokenPrefix+"_"+r.tokenName:r.tokenName,i=n.get(o);t.headers[r.authHeader]=i}return t},responseError:function(n){return 401==n.status&&(e.logout(),window.location=r.loginPage),t.reject(n)}}}])}(window.AZGARD=window.AZGARD||{}),function(t,e){t.Modules.AZGARD.provider("$auth",["AzgardConfig",function(t){Object.defineProperties(this,{httpInterceptor:{get:function(){return t.httpInterceptor},set:function(e){"function"==typeof e?t.httpInterceptor=e:t.httpInterceptor=function(){return e}}},baseUrl:{get:function(){return t.baseUrl},set:function(e){t.baseUrl=e}},loginUrl:{get:function(){return t.loginUrl},set:function(e){t.loginUrl=e}},registerUrl:{get:function(){return t.registerUrl},set:function(e){t.registerUrl=e}},profileUrl:{get:function(){return t.profileUrl},set:function(e){t.profileUrl=e}},loginSMSUrl:{get:function(){return t.loginSMSUrl},set:function(e){t.loginSMSUrl=e}},registerAdminUrl:{get:function(){return t.registerAdminUrl},set:function(e){t.registerAdminUrl=e}},logoutUrl:{get:function(){return t.logoutUrl},set:function(e){t.logoutUrl=e}},authHeader:{get:function(){return t.authHeader},set:function(e){t.authHeader=e}},authToken:{get:function(){return t.authToken},set:function(e){t.authToken=e}},loginPage:{get:function(){return t.loginPage},set:function(e){t.loginPage=e}}}),this.$get=["$q","AzgardShared","AzgardAction",function(t,e,r){function n(t,e){return r.login(t,e)}function o(t,e){return acton.register(t,e)}function i(){return r.logout()}function u(){return e.getToken()}function a(){return e.removeToken()}function l(){return e.getPayload()}function g(){return e.isAuthenticated()}function s(t,e){return r.getOTP(t,e)}function f(t,e){return r.loginOTP(t,e)}function c(t){return r.getProfile(t)}function d(t){e.profile=t}function A(){return e.profile}var p={};return p.login=n,p.register=o,p.logout=i,p.getToken=u,p.removeToken=a,p.getPayload=l,p.isAuthenticated=g,p.getOTP=s,p.loginOTP=f,p.getProfile=c,p.setProfile=d,p.getProfileData=A,p}]}])}(window.AZGARD=window.AZGARD||{}),function(t,e){t.Modules.AZGARD.factory("AzgardShared",["$q","$window","$log","AzgardConfig","AzgardStorage",function(t,r,n,o,i){function u(){return i.get(d)}function a(){var t=i.get(d);if(t&&3===t.split(".").length)try{var r=t.split(".")[1],n=r.replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(decodeURIComponent(escape(window.atob(n))))}catch(o){return e}}function l(t){if(!t)return n.warn("Please pass a value");var e=t.data;e&&(angular.isObject(e)?token=e.payload.token:angular.isString(e)&&(token=e)),i.set(d,token)}function g(){i.remove(d)}function s(){return i.remove(d),t.when()}function f(){var t=i.get(d);if(t){if(3===t.split(".").length)try{var e=t.split(".")[1],n=e.replace(/-/g,"+").replace(/_/g,"/"),o=JSON.parse(r.atob(n)).exp;if(o){var u=Math.round((new Date).getTime()/1e3)>=o;return!u}}catch(a){return!0}return!0}return!1}var c={},d=o.tokenPrefix?[o.tokenPrefix,o.tokenName].join("_"):o.tokenName;return c.getToken=u,c.getPayload=a,c.setToken=l,c.removeToken=g,c.logout=s,c.isAuthenticated=f,c.profile={},c}])}(window.AZGARD=window.AZGARD||{}),function(t,e){t.Modules.AZGARD.factory("AzgardStorage",["$window","$log","AzgardConfig",function(t,e,r){var n=function(){try{var e=r.storageType in t&&null!==t[r.storageType];if(e){var n=Math.random().toString(36).substring(7);t[r.storageType].setItem(n,""),t[r.storageType].removeItem(n)}return e}catch(o){return!1}}();return n||e.warn(r.storageType+" is not available."),{get:function(e){return n?t[r.storageType].getItem(e):store[e]},set:function(e,o){return n?t[r.storageType].setItem(e,o):store[e]=o},remove:function(e){return n?t[r.storageType].removeItem(e):delete store[e]}}}])}(window.AZGARD=window.AZGARD||{});